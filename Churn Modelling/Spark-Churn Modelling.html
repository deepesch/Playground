<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>ds-for-telco-with-output - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/img/favicon.ico"/>
<script>window.settings = {"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/databricks_guide/index.html","displayName":"Databricks Guide","icon":"question"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/sample_applications/index.html","displayName":"Application Examples","icon":"code"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/courses/index.html","displayName":"Training","icon":"graduation-cap"}],"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-virginia.s3.amazonaws.com","nodeInfo":{"node_types":[{"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized","container_memory_mb":28000,"memory_mb":30720,"num_cores":4.0},{"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized","container_memory_mb":12128,"memory_mb":15360,"num_cores":8.0}],"default_node_type_id":"memory-optimized"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-east-1b","isDefault":true},{"id":"us-east-1a","isDefault":false},{"id":"us-east-1c","isDefault":false},{"id":"us-east-1e","isDefault":false}],"nameAndEmail":"Deepesh Chaudhari (deepesh2255@live.com)","enablePublishNotebooks":false,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":true,"allowRunOnPendingClusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-30-10-144-U6118bb36ce-Sa2ee4664b2-2016-03-01-17:03:30.410441","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-30-10-144-U6118bb36ce-S9c254ab12a-2016-03-01-17:03:30.410441","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-U6118bb36ce-S9ca52d000d-2016-03-01-17:03:30.410441","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.0","packageLabel":"spark-1.6-jenkins-ip-10-30-10-144-U6118bb36ce-Sf90f83597b-2016-03-01-17:03:30.410441","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"defaultZoneId":"us-east-1b","serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"prefetchSidebarNodes":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.14","accountsLimit":-1,"enableNotebookGitBranching":true,"local":false,"displayDefaultContainerMemoryGB":30,"devTierHomepageDesign":"control","deploymentMode":"production","useSpotForWorkers":false,"enableUserInviteWorkflow":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"showHomepageFeaturedLinks":false,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"displayRowLimit":1000,"defaultSparkVersion":{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-30-10-144-U6118bb36ce-S9ca52d000d-2016-03-01-17:03:30.410441","upgradable":true,"deprecated":false,"customerVisible":true},"enableMountAclsConfig":false,"clusterPublisherRootId":7,"enableLatestJobRunResultPermalink":true,"disallowAddingAdmins":false,"enableSparkConfUI":true,"enableOrgSwitcherUI":false,"clustersLimit":-1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"19fc8db7-aefc-4a3f-9d07-da973e309dd8","useFixedStaticNotebookVersionForDevelopment":false,"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"enableWorkspaceAclService":true,"someName":"Deepesh Chaudhari","enableWorkspaceAcls":false,"gitHash":"6118bb36ced9f46ebd6354723c21ab530ae8e014","showWorkspaceFeaturedLinks":false,"userFullname":"Deepesh Chaudhari","allowFeedbackForumAccess":true,"enableClusterCreatePage":true,"enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"showDevTierBetaVersion":false,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":false,"userId":100004,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/","enableSparkPackages":true,"enableHybridClusterType":false,"enableNotebookHistoryUI":true,"availableWorkspaces":[{"name":"Workspace 0","orgId":0}],"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/1%20QuickStart%20Notebooks%20(Python).html","displayName":"Getting Started","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/3%20QuickStart%20DataFrames%20(Scala).html","displayName":"Introduction to DataFrames","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.cloud.databricks.com/docs/latest/featured_notebooks/DecisionTrees-Example.html","displayName":"Decision Trees in Spark","icon":"img/home/Scala_icon.svg"}],"databricksGuideStaticUrl":"","enableHybridClusters":true,"upgradeURL":"","clusterManagerAclsEnabled":false,"notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"user":"deepesh2255@live.com","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"tablesPublisherRootId":6,"enableNewInputWidgetUI":false,"accounts":true,"useFramedStaticNotebooks":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":12845,"name":"ds-for-telco-with-output","language":"python","commands":[{"version":"CommandV1","origId":13174,"guid":"2592892e-6a62-46cb-b64b-2114ebf2f731","subtype":"command","commandType":"auto","position":0.0,"command":"%md    # Load the data\n\nWe need to load data from a file in to a Spark DataFrame.\nEach row is an observed customer, and each column contains\nattributes of that customer.\n\n    Fields:\n    state: discrete.\n    account length: numeric.\n    area code: numeric.\n    phone number: discrete.\n    international plan: discrete.\n    voice mail plan: discrete.\n    number vmail messages: numeric.\n    total day minutes: numeric.\n    total day calls: numeric.\n    total day charge: numeric.\n    total eve minutes: numeric.\n    total eve calls: numeric.\n    total eve charge: numeric.\n    total night minutes: numeric.\n    total night calls: numeric.\n    total night charge: numeric.\n    total intl minutes: numeric.\n    total intl calls: numeric.\n    total intl charge: numeric.\n    number customer service calls: numeric.\n    churned: discrete.\n\n'Numeric' and 'discrete' do not adequately describe the fundamental differencecs in the attributes.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"slide"}},"nuid":"17a101ec-90d3-4b36-ab0e-a0e180014d54"},{"version":"CommandV1","origId":13175,"guid":"c502bc00-6bf4-49fd-b4a3-db2cfd771520","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SQLContext\nfrom pyspark.sql.types import *\n\nsqlContext = SQLContext(sc)\nschema = StructType([ \\\n    StructField(\"state\", StringType(), True), \\\n    StructField(\"account_length\", DoubleType(), True), \\\n    StructField(\"area_code\", StringType(), True), \\\n    StructField(\"phone_number\", StringType(), True), \\\n    StructField(\"intl_plan\", StringType(), True), \\\n    StructField(\"voice_mail_plan\", StringType(), True), \\\n    StructField(\"number_vmail_messages\", DoubleType(), True), \\\n    StructField(\"total_day_minutes\", DoubleType(), True), \\\n    StructField(\"total_day_calls\", DoubleType(), True), \\\n    StructField(\"total_day_charge\", DoubleType(), True), \\\n    StructField(\"total_eve_minutes\", DoubleType(), True), \\\n    StructField(\"total_eve_calls\", DoubleType(), True), \\\n    StructField(\"total_eve_charge\", DoubleType(), True), \\\n    StructField(\"total_night_minutes\", DoubleType(), True), \\\n    StructField(\"total_night_calls\", DoubleType(), True), \\\n    StructField(\"total_night_charge\", DoubleType(), True), \\\n    StructField(\"total_intl_minutes\", DoubleType(), True), \\\n    StructField(\"total_intl_calls\", DoubleType(), True), \\\n    StructField(\"total_intl_charge\", DoubleType(), True), \\\n    StructField(\"number_customer_service_calls\", DoubleType(), True), \\\n    StructField(\"churned\", StringType(), True)])\n\nchurn_df = sqlContext.read \\\n    .format('com.databricks.spark.csv') \\\n    .load(\"/FileStore/tables/fyarcesz1457233855557/churn.all\", schema = schema)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;_get_object_id&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-6-989e20164a96&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      5</span> schema <span class=\"ansiyellow\">=</span> StructType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;state&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;account_length&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;area_code&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;phone_number&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;intl_plan&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;voice_mail_plan&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;number_vmail_messages&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_day_minutes&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_day_calls&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_day_charge&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_eve_minutes&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_eve_calls&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_eve_charge&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_night_minutes&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_night_calls&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_night_charge&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_intl_minutes&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_intl_calls&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;total_intl_charge&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;number_customer_service_calls&quot;</span><span class=\"ansiyellow\">,</span> DoubleType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>     StructField<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;churned&quot;</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 7</span><span class=\"ansiyellow\"> </span>churn_data <span class=\"ansiyellow\">=</span> sqlContext<span class=\"ansiyellow\">.</span>read     <span class=\"ansiyellow\">.</span>format<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;com.databricks.spark.csv&apos;</span><span class=\"ansiyellow\">)</span>     <span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansicyan\">load</span><span class=\"ansiblue\">(self, path, format, schema, **options)</span>\n<span class=\"ansigreen\">    119</span>         self<span class=\"ansiyellow\">.</span>options<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">**</span>options<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    120</span>         <span class=\"ansigreen\">if</span> path <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 121</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    122</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    123</span>             <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_df<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jreader<span class=\"ansiyellow\">.</span>load<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    527</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    528</span>         args_command = &apos;&apos;.join(\n<span class=\"ansigreen\">--&gt; 529</span><span class=\"ansiyellow\">                 [get_command_part(arg, self.pool) for arg in new_args])\n</span><span class=\"ansigreen\">    530</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    531</span>         command <span class=\"ansiyellow\">=</span> CALL_COMMAND_NAME <span class=\"ansiyellow\">+</span><span class=\"ansired\">\\</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_command_part</span><span class=\"ansiblue\">(parameter, python_proxy_pool)</span>\n<span class=\"ansigreen\">    263</span>             command_part <span class=\"ansiyellow\">+=</span> <span class=\"ansiblue\">&apos;;&apos;</span> <span class=\"ansiyellow\">+</span> interface<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    264</span>     <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 265</span><span class=\"ansiyellow\">         </span>command_part <span class=\"ansiyellow\">=</span> REFERENCE_TYPE <span class=\"ansiyellow\">+</span> parameter<span class=\"ansiyellow\">.</span>_get_object_id<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    266</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    267</span>     command_part <span class=\"ansiyellow\">+=</span> <span class=\"ansiblue\">&apos;\\n&apos;</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;_get_object_id&apos;\n</div>","startTime":1.457237981133E12,"submitTime":1.457237976943E12,"finishTime":1.457237981211E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"slideshow":{"slide_type":"fragment"}},"nuid":"84aaafc0-c739-41d8-8105-7e1d31ef9b7d"},{"version":"CommandV1","origId":13177,"guid":"99c2ea3e-adda-4f2f-ad74-e1eb76e939e0","subtype":"command","commandType":"auto","position":3.0,"command":"count = churn_df.count()\nvoice_mail_plans = churn_data.filter(churn_data.voice_mail_plan == \" yes\").count()\n\n\"%d, %d\" % (count, voice_mail_plans)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">59</span><span class=\"ansired\">]: </span>&apos;5000, 1323&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;voice_mail_plan&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AttributeError</span>                            Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-4-7c6e49387146&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> count <span class=\"ansiyellow\">=</span> churn_data<span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>voice_mail_plans <span class=\"ansiyellow\">=</span> churn_data<span class=\"ansiyellow\">.</span>filter<span class=\"ansiyellow\">(</span>churn_data<span class=\"ansiyellow\">.</span>voice_mail_plan <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&quot; yes&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>count<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansiblue\">&quot;%d, %d&quot;</span> <span class=\"ansiyellow\">%</span> <span class=\"ansiyellow\">(</span>count<span class=\"ansiyellow\">,</span> voice_mail_plans<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AttributeError</span>: &apos;RDD&apos; object has no attribute &apos;voice_mail_plan&apos;\n</div>","startTime":1.457237990079E12,"submitTime":1.457237985886E12,"finishTime":1.457237994301E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"slideshow":{"slide_type":"fragment"}},"nuid":"a329f1cc-b4d2-4cb6-8df8-df7858dcc7f4"},{"version":"CommandV1","origId":13178,"guid":"0b35cd24-c5f8-49c6-b602-92a359d60aa7","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n\n Intuitively we would find out customers who made one or more customer service calls & How many have more than one? ","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"subslide"}},"nuid":"78c9c8af-4a5a-4498-a7bc-48c26b5483ef"},{"version":"CommandV1","origId":13180,"guid":"7a6ca68c-fa78-4954-8182-3b297663f646","subtype":"command","commandType":"auto","position":5.0,"command":"churn_result = churn_df[\"churned\"]","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-11-371c8cefc0ec&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> churn_result <span class=\"ansiyellow\">=</span> churn_data<span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;churned&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>y <span class=\"ansiyellow\">=</span> np<span class=\"ansiyellow\">.</span>where<span class=\"ansiyellow\">(</span>churn_result <span class=\"ansiyellow\">==</span> <span class=\"ansiblue\">&apos;True.&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">,</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;np&apos; is not defined\n</div>","startTime":1.457238008344E12,"submitTime":1.457238004149E12,"finishTime":1.457238008357E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true},"nuid":"35467a77-dbdd-4e87-b922-9ba568b37bdf"},{"version":"CommandV1","origId":13182,"guid":"2f88f0b4-a806-498a-a7b5-9c914a367bfe","subtype":"command","commandType":"auto","position":5.21875,"command":"multiple_service_calls = churn_df.filter(churn_df.number_customer_service_calls > 0).count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-68-8f1219ddecd5&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">1</span>\n<span class=\"ansiyellow\">    multiple_service_calls = churn_df.filter(churn_df.number_customer_service_calls) &gt; 0)</span>\n<span class=\"ansigrey\">                                                                                        ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","startTime":1.457238217543E12,"submitTime":1.457238213349E12,"finishTime":1.457238219356E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"4b8aad66-fe02-45ba-a8ba-301d20f60066"},{"version":"CommandV1","origId":13183,"guid":"f010f309-7869-4665-8c7e-b3f11a10a4e5","subtype":"command","commandType":"auto","position":5.328125,"command":"multiple_service_calls","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">70</span><span class=\"ansired\">]: </span>3977\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.45723822833E12,"submitTime":1.457238224129E12,"finishTime":1.457238228356E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"07a0aa6c-5ab1-4dc1-8973-f77d740a6b92"},{"version":"CommandV1","origId":13185,"guid":"809664a5-3c7b-4713-93fc-c13cbe6a3612","subtype":"command","commandType":"auto","position":7.0,"command":"sample_data = churn_df.sample(False, 0.5, 83).toPandas()\nsample_data.head()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">77</span><span class=\"ansired\">]: </span>\n  state  account_length area_code phone_number intl_plan voice_mail_plan  \\\n0    NJ             137       415     358-1921        no              no   \n1    AL             118       510     391-8027       yes              no   \n2    MA             121       510     355-9993        no             yes   \n3    WV             141       415     330-8173       yes             yes   \n4    MT              95       510     394-8006        no              no   \n\n   number_vmail_messages  total_day_minutes  total_day_calls  \\\n0                      0              243.4              114   \n1                      0              223.4               98   \n2                     24              218.2               88   \n3                     37              258.6               84   \n4                      0              156.6               88   \n\n   total_day_charge        ...         total_eve_calls  total_eve_charge  \\\n0             41.38        ...                     110             10.30   \n1             37.98        ...                     101             18.75   \n2             37.09        ...                     108             29.62   \n3             43.96        ...                     111             18.87   \n4             26.62        ...                      75             21.05   \n\n   total_night_minutes  total_night_calls  total_night_charge  \\\n0                162.6                104                7.32   \n1                203.9                118                9.18   \n2                212.6                118                9.57   \n3                326.4                 97               14.69   \n4                192.3                115                8.65   \n\n   total_intl_minutes  total_intl_calls  total_intl_charge  \\\n0                12.2                 5               3.29   \n1                 6.3                 6               1.70   \n2                 7.5                 7               2.03   \n3                11.2                 5               3.02   \n4                12.3                 5               3.32   \n\n   number_customer_service_calls  churned  \n0                              0   False.  \n1                              0   False.  \n2                              3   False.  \n3                              0   False.  \n4                              3   False.  \n\n[5 rows x 21 columns]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.457239025276E12,"submitTime":1.457238984867E12,"finishTime":1.457239025825E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"slideshow":{"slide_type":"fragment"}},"nuid":"4461b7fd-a24f-44fc-9873-c2bd31ec99ab"},{"version":"CommandV1","origId":13202,"guid":"408370c8-5da2-42a5-89cc-71c862c95a50","subtype":"command","commandType":"auto","position":23.0,"command":"%md # Feature Extraction and Model Training\n\n* Code features that are not already numeric\n* Gather all features we need into a single column in the DataFrame.\n* Split labeled data into training and testing set\n* Fit the model to the training data.\n\n## Feature Extraction\nWe need to define our input features.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"subslide"}},"nuid":"9ff85ea1-8572-4e80-9381-55490c2f76da"},{"version":"CommandV1","origId":13203,"guid":"5799f265-1804-40b9-8204-9615a6a023bb","subtype":"command","commandType":"auto","position":24.0,"command":"from pyspark.ml.feature import StringIndexer\nfrom pyspark.ml.feature import VectorAssembler\n\nlabel_indexer = StringIndexer(inputCol = 'churned', outputCol = 'label')\nplan_indexer = StringIndexer(inputCol = 'intl_plan', outputCol = 'intl_plan_indexed')\n\nassembler = VectorAssembler(\n    inputCols = ['intl_plan_indexed'] + reduced_numeric_cols,\n    outputCol = 'features')","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;reduced_numeric_cols&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-96-3e6dcc32252f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> assembler = VectorAssembler(\n<span class=\"ansigreen\">----&gt; 8</span><span class=\"ansiyellow\">     </span>inputCols <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;intl_plan_indexed&apos;</span><span class=\"ansiyellow\">]</span> <span class=\"ansiyellow\">+</span> reduced_numeric_cols<span class=\"ansiyellow\">,</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span>     outputCol = &apos;features&apos;)\n\n<span class=\"ansired\">NameError</span>: name &apos;reduced_numeric_cols&apos; is not defined\n</div>","startTime":1.457295189366E12,"submitTime":1.457295183638E12,"finishTime":1.457295189846E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"slideshow":{"slide_type":"fragment"}},"nuid":"cc87ba4b-9ade-4bf0-8b6b-8dabbcfe9a0d"},{"version":"CommandV1","origId":13204,"guid":"e82e2b10-9a3c-4195-a9f9-29b95dfc3cc0","subtype":"command","commandType":"auto","position":25.0,"command":"%md ## Model Training\n\nWe can now define our classifier and pipeline. With this done, we can split our labeled data in train and test sets and fit a model.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"subslide"}},"nuid":"9b18d1ae-f2a0-4fee-87f1-c3c36d2c0276"},{"version":"CommandV1","origId":13212,"guid":"fb1a716d-464e-4980-80f6-ccd4186077d4","subtype":"command","commandType":"auto","position":25.5,"command":"%md #DecisionTreeClassifier","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"91ffdaa3-ebc2-4d6c-99dc-fbc2d4cb4b37"},{"version":"CommandV1","origId":13205,"guid":"4542143e-ec0b-402a-a828-f8200dd89431","subtype":"command","commandType":"auto","position":26.0,"command":"from pyspark.ml import Pipeline\nfrom pyspark.ml.classification import DecisionTreeClassifier\n\nclassifier = DecisionTreeClassifier(labelCol = 'label', featuresCol = 'features')\n\npipeline = Pipeline(stages=[plan_indexer, label_indexer, assembler, classifier])\n\n(train, test) = churn_data.randomSplit([0.7, 0.3])\nmodel = pipeline.fit(train)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.457295192933E12,"submitTime":1.457295187193E12,"finishTime":1.457295195541E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":true,"slideshow":{"slide_type":"fragment"}},"nuid":"fd85269f-5e07-4089-ae40-c1ba4cfb2af7"},{"version":"CommandV1","origId":13206,"guid":"f49e21d8-7806-438c-b799-6a3a61cbb21b","subtype":"command","commandType":"auto","position":27.0,"command":"%md ## Model Evaluation\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"subslide"}},"nuid":"33a55455-158a-45b4-bc6c-fb645f6c046a"},{"version":"CommandV1","origId":13207,"guid":"5b3acb4c-6fd4-4253-9452-64cca14ec920","subtype":"command","commandType":"auto","position":29.0,"command":"from pyspark.ml.evaluation import BinaryClassificationEvaluator\n\npredictions = model.transform(test)\nevaluator = BinaryClassificationEvaluator()\nauroc = evaluator.evaluate(predictions, {evaluator.metricName: \"areaUnderROC\"})\naupr = evaluator.evaluate(predictions, {evaluator.metricName: \"areaUnderPR\"})\n\"The AUROC is %s and the AUPR is %s.\" % (auroc, aupr)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">140</span><span class=\"ansired\">]: </span>&apos;The AUROC is 0.391466132749 and the AUPR is 0.209598777188.&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;model&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-97-f4f08843e0b9&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>ml<span class=\"ansiyellow\">.</span>evaluation <span class=\"ansigreen\">import</span> BinaryClassificationEvaluator<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>predictions <span class=\"ansiyellow\">=</span> model<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>test<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> evaluator <span class=\"ansiyellow\">=</span> BinaryClassificationEvaluator<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> auroc <span class=\"ansiyellow\">=</span> evaluator<span class=\"ansiyellow\">.</span>evaluate<span class=\"ansiyellow\">(</span>predictions<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">{</span>evaluator<span class=\"ansiyellow\">.</span>metricName<span class=\"ansiyellow\">:</span> <span class=\"ansiblue\">&quot;areaUnderROC&quot;</span><span class=\"ansiyellow\">}</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;model&apos; is not defined\n</div>","startTime":1.457295198869E12,"submitTime":1.457295193144E12,"finishTime":1.457295200084E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"slideshow":{"slide_type":"subslide"}},"nuid":"13c07f1c-6505-48c1-b2f4-3f795fbafa0b"},{"version":"CommandV1","origId":13208,"guid":"762d5726-b582-4423-90b2-25cb9224a762","subtype":"command","commandType":"auto","position":30.0,"command":"%md #RandomForestClassifier\n\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"slideshow":{"slide_type":"subslide"}},"nuid":"daa6861d-3392-42fd-b22d-16dc0853fbaf"},{"version":"CommandV1","origId":13209,"guid":"f322e2a5-f64f-421c-9371-902e8a56be49","subtype":"command","commandType":"auto","position":31.0,"command":"from pyspark.ml.classification import RandomForestClassifier\n\nclassifier = RandomForestClassifier(labelCol= 'label', featuresCol= 'features', maxDepth= 10, numTrees= 100, impurity = 'entropy')\n\npipeline = Pipeline(stages=[plan_indexer, label_indexer, assembler, classifier])\n\n(train, test) = churn_data.randomSplit([0.7, 0.3])\n\nmodel = pipeline.fit(train)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: Field &quot;Label&quot; does not exist.","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-144-8c5789cf9c68&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">,</span> test<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">=</span> churn_data<span class=\"ansiyellow\">.</span>randomSplit<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0.7</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">0.3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      8</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 9</span><span class=\"ansiyellow\"> </span>model <span class=\"ansiyellow\">=</span> pipeline<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>train<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     63</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 65</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     67</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    197</span>                     dataset <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    198</span>                 <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span>  <span class=\"ansired\"># must be an Estimator</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 199</span><span class=\"ansiyellow\">                     </span>model <span class=\"ansiyellow\">=</span> stage<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    200</span>                     transformers<span class=\"ansiyellow\">.</span>append<span class=\"ansiyellow\">(</span>model<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    201</span>                     <span class=\"ansigreen\">if</span> i <span class=\"ansiyellow\">&lt;</span> indexOfLastEstimator<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/pipeline.py</span> in <span class=\"ansicyan\">fit</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">     63</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 65</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     66</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     67</span>             raise ValueError(&quot;Params must be either a param map or a list/tuple of param maps, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_fit</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    130</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    131</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 132</span><span class=\"ansiyellow\">         </span>java_model <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_fit_java<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    133</span>         <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_create_model<span class=\"ansiyellow\">(</span>java_model<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    134</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.py</span> in <span class=\"ansicyan\">_fit_java</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    127</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    128</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 129</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    130</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    131</span>     <span class=\"ansigreen\">def</span> _fit<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.8.2.1-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">    536</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>         return_value = get_return_value(answer, self.gateway_client,\n<span class=\"ansigreen\">--&gt; 538</span><span class=\"ansiyellow\">                 self.target_id, self.name)\n</span><span class=\"ansigreen\">    539</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    540</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     40</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     41</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 42</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     43</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     44</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: Field &quot;Label&quot; does not exist.\n</div>","startTime":1.45729575579E12,"submitTime":1.457295750034E12,"finishTime":1.457295761577E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true,"slideshow":{"slide_type":"fragment"}},"nuid":"3c346997-5e29-4e03-843c-45e7be070f39"},{"version":"CommandV1","origId":13213,"guid":"d86c6e75-d34d-456e-987c-19d0a2f87e30","subtype":"command","commandType":"auto","position":31.5,"command":"%md ## Model Evaluation","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"86d0982f-f54d-47e5-ae0c-a1fb9939f7f1"},{"version":"CommandV1","origId":13210,"guid":"0dc6d281-aa66-4876-8950-1e8cdc6f5e23","subtype":"command","commandType":"auto","position":32.0,"command":"from pyspark.ml.evaluation import BinaryClassificationEvaluator\n\npredictions = model.transform(test)\nevaluator = BinaryClassificationEvaluator()\nauroc = evaluator.evaluate(predictions, {evaluator.metricName: \"areaUnderROC\"})\naupr = evaluator.evaluate(predictions, {evaluator.metricName: \"areaUnderPR\"})\n\"The AUROC is %s and the AUPR is %s.\" % (auroc, aupr)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">147</span><span class=\"ansired\">]: </span>&apos;The AUROC is 0.821409338726 and the AUPR is 0.714353078076.&apos;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"startTime":1.457295990776E12,"submitTime":1.457295985027E12,"finishTime":1.457295992966E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"deepesh2255@live.com","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true},"nuid":"4622e2eb-e9b6-4552-aa29-534115b284ff"}],"dashboards":[],"guid":"f7038dea-fb1b-4d78-bb6d-e6fa6350bfd3","globalVars":{},"iPythonMetadata":{"nbformat":4.0,"IPythonMetadata":{"celltoolbar":"Slideshow","kernelspec":{"display_name":"Python 2","language":"python","name":"python2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython2","codemirror_mode":{"name":"ipython","version":2.0},"version":"2.7.6","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201603010716030000-6118bb36ced9f46ebd6354723c21ab530ae8e014/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
